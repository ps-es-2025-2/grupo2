<div class="container" style="padding: 20px;">
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <h2>ğŸ“‹ RelatÃ³rio de Fichas Emitidas</h2>
    <button routerLink="/dashboard" style="background: #6c757d; color: white; border: none; padding: 8px 15px; cursor: pointer;">Voltar</button>
  </div>
  <hr>

  <div style="display: flex; gap: 20px; margin-bottom: 20px; align-items: center;">
    <div style="flex: 1;">
      <input type="text" [(ngModel)]="filtro" placeholder="ğŸ” Pesquisar por cÃ³digo ou status..." 
             style="width: 100%; padding: 10px; border: 1px solid #ccc;">
    </div>
    <div style="background: #e3f2fd; padding: 10px 20px; border-radius: 5px; font-weight: bold;">
      Total Emitido: <span style="color: blue;">R$ {{ calcularTotalVendido() | number:'1.2-2' }}</span>
    </div>
  </div>

  <table width="100%" border="1" style="border-collapse: collapse; text-align: center;">
    <thead>
      <tr style="background: #343a40; color: white;">
        <th>Data/Hora</th>
        <th>CÃ³digo</th>
        <th>Valor</th>
        <th>Status</th>
        <th>AÃ§Ãµes</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ficha of fichasFiltradas; let i = index">
        <td>{{ ficha.dataHora | date:'dd/MM/yyyy HH:mm' }}</td>
        
        <td style="font-family: monospace; font-weight: bold; font-size: 1.1em;">
          {{ ficha.codigo }}
        </td>
        
        <td>R$ {{ ficha.valor | number:'1.2-2' }}</td>
        
        <td>
          <span [style.background]="ficha.status === 'ATIVA' ? '#28a745' : '#dc3545'"
                style="color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.9em;">
            {{ ficha.status }}
          </span>
          <div *ngIf="ficha.status === 'BAIXADA'" style="font-size: 0.7em; color: gray;">
            {{ ficha.dataBaixa | date:'HH:mm' }}
          </div>
        </td>

        <td>
          <button *ngIf="ficha.status === 'ATIVA'" (click)="darBaixa(ficha)" 
                  style="background: #ffc107; border: none; padding: 5px 10px; cursor: pointer; margin-right: 5px;" title="Marcar como usada">
            â¬‡ï¸ Baixar
          </button>

          <button *ngIf="ficha.status === 'BAIXADA'" (click)="reativar(ficha)" 
                  style="background: #17a2b8; color: white; border: none; padding: 5px 10px; cursor: pointer; margin-right: 5px;" title="Reativar ficha">
            ğŸ”„
          </button>

          <button (click)="excluir(i)" 
                  style="background: #dc3545; color: white; border: none; padding: 5px 10px; cursor: pointer;" title="Remover registro">
            ğŸ—‘ï¸
          </button>
        </td>
      </tr>

      <tr *ngIf="fichasFiltradas.length === 0">
        <td colspan="5" style="padding: 20px; color: #777;">Nenhuma ficha encontrada.</td>
      </tr>
    </tbody>
  </table>
</div>