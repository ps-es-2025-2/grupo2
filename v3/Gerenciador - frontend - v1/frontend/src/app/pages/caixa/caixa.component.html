<div class="container-caixa">
  
  <div class="header">
    <h2>Gerenciamento de Caixa</h2>
    <button routerLink="/dashboard" class="btn-voltar">Voltar</button>
  </div>
  <hr>

  <div class="status-panel" [class.aberto]="status === 'ABERTO'" [class.fechado]="status === 'FECHADO'">
    <p class="status-label">STATUS ATUAL: <strong>{{ status }}</strong></p>
    <div class="saldo-valor">R$ {{ saldo | number:'1.2-2' }}</div>
    <p class="saldo-info">Dinheiro em Gaveta</p>
  </div>

  <div class="acoes-grid">
    
    <button *ngIf="status === 'FECHADO'" (click)="abrirCaixa()" class="btn-card btn-verde">
      ðŸ”“ <br> ABRIR CAIXA
    </button>

    <button *ngIf="status === 'ABERTO'" routerLink="/venda" class="btn-card btn-roxo">
      ðŸ›’ <br> FRENTE DE CAIXA (PDV)
    </button>

    <button *ngIf="status === 'ABERTO'" (click)="realizarSangria()" class="btn-card btn-laranja">
      ðŸ’¸ <br> SANGRIA / RETIRADA
    </button>

    <button (click)="toggleDetalhes()" class="btn-card btn-azul">
      ðŸ“œ <br> MOVIMENTO DO CAIXA
    </button>

    <button *ngIf="status === 'ABERTO'" (click)="fecharCaixa()" class="btn-card btn-vermelho">
      ðŸš« <br> FECHAR CAIXA
    </button>

  </div>

  <div *ngIf="mostrarDetalhes" class="historico-panel">
    <h3>Ãšltimas MovimentaÃ§Ãµes</h3>
    <table width="100%" border="1">
      <thead>
        <tr>
          <th>Hora</th>
          <th>Tipo</th>
          <th>DescriÃ§Ã£o</th>
          <th>Valor</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let mov of movimentacoes">
          <td>{{ mov.data | date:'HH:mm' }}</td>
          <td><span class="badge">{{ mov.tipo }}</span></td>
          <td>{{ mov.descricao }}</td>
          <td [style.color]="mov.tipo === 'SANGRIA' ? 'red' : 'green'" style="font-weight: bold;">
            R$ {{ mov.valor | number:'1.2-2' }}
          </td>
        </tr>
        <tr *ngIf="movimentacoes.length === 0">
          <td colspan="4">Nenhum movimento registrado hoje.</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>