<div class="page-container">
  <header class="top-header">
    <div class="header-brand">
      <h1>Caneco Cheio</h1>
    </div>
    <nav class="top-nav">
      <a routerLink="/produtos">Gerenciar Produtos</a>
      <a routerLink="/eventos">Gerenciar Eventos</a>
      <a routerLink="/estoque">Estoque</a>
      <a routerLink="/venda">Nova Venda (PDV)</a>
      <a routerLink="/caixa">Controle de Caixa</a>
      <a routerLink="/validacao" routerLinkActive="active">Validar Ficha</a>
      <a routerLink="/venda-fichas">Vender Ficha</a>
      <a routerLink="/consultar-fichas">Relat√≥rio de Fichas</a>
    </nav>
    <button class="logout-btn" routerLink="/dashboard">Voltar</button>
  </header>

  <div class="main-content">
    <div class="page-header">
      <h2>Validar Ficha / QR Code</h2>
    </div>

    <div class="validation-card">
      <h3>Digite o C√≥digo da Ficha</h3>
      <form class="validation-form" (ngSubmit)="consultarFicha()">
        <div class="form-field">
          <label>C√≥digo da Ficha:</label>
          <input type="text" [(ngModel)]="codigoInput" name="codigo" placeholder="Ex: a1b2-c3d4..." required />
        </div>
        <button type="submit" class="btn-validate">CONSULTAR</button>
      </form>

      <div *ngIf="mensagemErro" class="result-card result-error">
        <h4>Erro</h4>
        <p>{{ mensagemErro }}</p>
      </div>

      <div *ngIf="carregando" style="text-align: center; padding: 2rem;">
        <p>Carregando...</p>
      </div>

<<<<<<< HEAD
      <div *ngIf="fichaEncontrada" class="result-card" 
           [class.result-success]="fichaEncontrada.status === 'GERADA' && fichaEncontrada.saldo > 0" 
           [class.result-error]="fichaEncontrada.status === 'UTILIZADA' || fichaEncontrada.saldo <= 0">
        <h4>
          <span *ngIf="fichaEncontrada.status === 'GERADA' && fichaEncontrada.saldo > 0">‚úÖ FICHA V√ÅLIDA COM SALDO</span>
          <span *ngIf="fichaEncontrada.saldo <= 0">‚ùå FICHA SEM SALDO</span>
          <span *ngIf="fichaEncontrada.status === 'UTILIZADA' && fichaEncontrada.saldo > 0">‚ö†Ô∏è FICHA PARCIALMENTE USADA</span>
        </h4>
=======
      <div *ngIf="fichaEncontrada" class="result-card" [class.result-success]="fichaEncontrada.status === 'GERADA'" [class.result-error]="fichaEncontrada.status !== 'GERADA'">
        <h4>{{ fichaEncontrada.status === 'GERADA' ? '‚úÖ FICHA V√ÅLIDA' : '‚ùå FICHA J√Å UTILIZADA' }}</h4>
>>>>>>> 7a918497ebee151fabee2fa8e53dade07b3544a5
        
        <div style="text-align: left; margin: 1rem 0;">
          <p><strong>Cliente:</strong> {{ fichaEncontrada.cliente.nome }}</p>
          <p *ngIf="fichaEncontrada.cliente.telefone"><strong>Telefone:</strong> {{ fichaEncontrada.cliente.telefone }}</p>
          <p *ngIf="fichaEncontrada.cliente.email"><strong>Email:</strong> {{ fichaEncontrada.cliente.email }}</p>
          <p><strong>C√≥digo:</strong> <code style="background: #f0f0f0; padding: 5px 10px; border-radius: 4px;">{{ fichaEncontrada.codigo }}</code></p>
<<<<<<< HEAD
          <p style="font-size: 1.2em; font-weight: bold;" [style.color]="fichaEncontrada.saldo > 0 ? '#28a745' : '#dc3545'">
            <strong>üí∞ Saldo Dispon√≠vel:</strong> R$ {{ fichaEncontrada.saldo.toFixed(2) }}
          </p>
          <p><strong>Limite Original:</strong> R$ {{ fichaEncontrada.limite.toFixed(2) }}</p>
=======
          <p><strong>Saldo:</strong> R$ {{ fichaEncontrada.saldo.toFixed(2) }}</p>
          <p><strong>Limite:</strong> R$ {{ fichaEncontrada.limite.toFixed(2) }}</p>
>>>>>>> 7a918497ebee151fabee2fa8e53dade07b3544a5
          <p><strong>Status:</strong> 
            <span [style.color]="fichaEncontrada.status === 'GERADA' ? '#28a745' : '#dc3545'" style="font-weight: bold;">
              {{ fichaEncontrada.status }}
            </span>
          </p>
        </div>
        
        <div style="display: flex; gap: 10px; margin-top: 1.5rem;">
<<<<<<< HEAD
          <button *ngIf="fichaEncontrada.saldo > 0" 
=======
          <button *ngIf="fichaEncontrada.status === 'GERADA'" 
>>>>>>> 7a918497ebee151fabee2fa8e53dade07b3544a5
                  (click)="entregarProduto()"
                  [disabled]="carregando"
                  class="btn-validate" 
                  style="flex: 1; background: #28a745;">
<<<<<<< HEAD
            {{ carregando ? 'Processando...' : 'üç∫ CONSUMIR/ENTREGAR' }}
=======
            {{ carregando ? 'Processando...' : 'üç∫ ENTREGAR PRODUTO' }}
>>>>>>> 7a918497ebee151fabee2fa8e53dade07b3544a5
          </button>
          
          <button (click)="limparBusca()" 
                  class="btn-validate" 
                  style="flex: 1; background: #6c757d;">
            üîÑ NOVA CONSULTA
          </button>
        </div>
        
<<<<<<< HEAD
        <p *ngIf="fichaEncontrada.saldo <= 0" 
           style="margin-top: 1rem; font-style: italic; color: #dc3545;">
          ‚ö†Ô∏è Esta ficha n√£o possui mais saldo dispon√≠vel. Todo o cr√©dito j√° foi consumido.
        </p>
        <p *ngIf="fichaEncontrada.saldo > 0 && fichaEncontrada.saldo < fichaEncontrada.limite" 
           style="margin-top: 1rem; font-style: italic; color: #ff9800;">
          ‚ÑπÔ∏è Esta ficha foi parcialmente utilizada. Saldo restante: R$ {{ fichaEncontrada.saldo.toFixed(2) }}
=======
        <p *ngIf="fichaEncontrada.status !== 'GERADA'" 
           style="margin-top: 1rem; font-style: italic; color: #dc3545;">
          ‚ö†Ô∏è Esta ficha j√° foi utilizada e n√£o pode ser reutilizada.
>>>>>>> 7a918497ebee151fabee2fa8e53dade07b3544a5
        </p>
      </div>
    </div>
  </div>
</div>